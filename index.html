<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office Environment Monitoring Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- Three.js -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/FBXLoader.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0ea5e9',
                        secondary: '#0369a1',
                        accent: '#38bdf8',
                        success: '#22c55e',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        dark: '#0f172a',
                        light: '#f8fafc'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .bg-gradient-dashboard {
                background: linear-gradient(
                    0deg,
                    #ffffff 0%,     /* pure white at the top */
                    #e3ffdb 50%,    /* green in the middle */
                    #ffffff 100%    /* white again at the bottom */
                );
            }

            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .card {
                @apply bg-white/10 backdrop-blur-lg rounded-xl border border-white/20;
            }
            .card-header {
                @apply text-xl font-bold text-black mb-2 flex items-center justify-between;
            }
            .card-body {
                @apply p-4;
            }
            .table-row {
                @apply border-b border-white/10 py-2;
            }
            .table-cell {
                @apply px-4 py-2 text-black;
            }
            .status-online {
                @apply bg-success rounded-full w-3 h-3 inline-block mr-2;
            }
            .status-offline {
                @apply bg-danger rounded-full w-3 h-3 inline-block mr-2;
            }
        }
    </style>
</head>
<body class="bg-gradient-dashboard min-h-screen text-black">
    <div class="container mx-auto px-4">
        <!-- Header -->
        <header class="mb-2">
            <div class="flex justify-between items-center">
                <div>
                 <img src="logo.png" 
                                 alt="Office Floor Plan" 
                                 class="w-72 h-auto ">
                </div>
                <div class="flex justify-between">
                <!-- Left: Time/Date -->
                <div class="text-center mt-5">
                    <p class="text-5xl text-black" id="last-updated-time"></p>
                    <p class="font-medium text-black" id="last-updated-date"></p>
                </div>
                <div class="flex flex-col items-center ml-8">
                    <img id="icon" alt="Weather Icon" class="h-24 w-24 my-2">
                </div>
                </div>
                <!-- Right: Weather Column -->
                <div class="flex flex-col items-center">
                    <p class="text-4xl text-black"><span id="temp"></span> Â°C</p>
                    <p class="text-4xl text-black"><span id="humidity"></span> %</p>
                </div>
                </div>

            </div>
        </header>
        <!-- Main Content -->
        <main class="grid grid-cols-1 gap-6 ml-36 mr-36">
            <!-- 3D Floor Plan Section -->
            <section class="card h-auto ">
                <div class="card-header justify-center">
                    <span><p class = "text-black">3D FLOOR PLAN</p></span>
                    
                </div>
                    <div class="relative ml-36">
                        <div id="floorplan-container"style="width:450px; height:650px;" >
                            <img id="floorplan-img"
                                 src="L20.png" 
                                 alt="Office Floor Plan" 
                                 class = "mx-auto"
                                 style="width:450px; height:650px;"
                                 >
                            
                            <!-- SVG Overlay for polygonal zones -->
                            <svg id="zones-L20" class="absolute top-0 left-0 " viewBox="0 0 100 100" preserveAspectRatio="none" style="width:450px; height:650px;">
                                <polygon class="zone " data-zone="zone1" points="43.6,8.8 52.2,9.6 51.1,12.8 42.3 11.8" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone2" points="52.2,9.6, 51.1,12.8 59.8,13.4 60.9,10.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone3" points="59.8,13.4 60.9,10.4 69.2,11.2 68.3,14.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone4" points="69.2,11.2 68.3,14.4 73.6,14.8 74.4,11.7" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone5" points="73.6,14.8 74.4,11.7 87.3,13.0 86.5,16.0" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone23" points="42.3,11.8 80.6,15.5 79.9,19.3 85.9,20.2 85.0,24.6 36.9,19.6 40.7,16.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone6" points="80.6,15.5 86.5,16 85.8,20 79.9,19.3" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone7" points="36.9,19.6 34.6,21.6 26.4,42.4 41.1,44.0 42.2,41.5 45.2,41.9 50.3,25.8 48.7,25.6 50.4,21.0" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone8" points="26.4,42.2 25.6,44.3 24.5,46.0 31.6,46.9 33.0,43.1" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone9" points="24.4,45.9 31.5,46.8 30.5,50.1 38.9,51.1 37.0,56.0 20.7,54.2 20.0,55.6 18.4,55.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone10" points="18.2,55.3 11.9,65.2 36.3,68.6 39.9,57.3 36.7,57.0 37.0,56.0 20.7,54.2 20.0,55.6" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone11" points="11.9,65.5 6.3,73.7 22.6,75.5 25.5,67.3" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone12" points="22.6,75.5 25.5,67.3 29.0,67.6 26.0,75.9 " style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone13" points="6.3,73.7 26.0,75.9 23.4,83.7 21.2,83.5 20.3,84.7 0.7,82.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone14" points="26.4,75.0 29.1,67.6 39.6,69.0 36.8,76.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone15" points="26.4,74.9 23.6,83.7 21.2,83.5 20.3,84.7 34.8,86.5 35.5,85.1 34.3,84.9 36.8,76.1" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone16" points="45.1,41.8 42.2,41.6 41.1,44.0 33.0,43.1 30.5,50.2 38.8,51.0 36.7,56.9 39.9,57.3" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone17" points="50.2,21.1 48.6,25.5 61.0,26.8 61.6,25.1 64.0,25.3 64.6,22.6" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone18" points="72.1,23.4 71.5,25.5 77.6,26.1 75.8,34.1 79.9,34.6 79.7,35.7 86.9,36.5 89.9,30.1 84.2,28.8 84.9,24.6" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone19" points="64.6,22.5 63.9,25.2 69.1,25.8 69.6,23.0" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone20" points="71.5,25.5 70.9,28.1 77.0,28.8 77.5,26.0" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone21" points="71.0,28.1 70.3,30.7 76.2,31.4 77.0,28.8" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                                <polygon class="zone" data-zone="zone22" points="70.4,30.7 69.2,34.6 75.5,35.3 76.3,31.3" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> 
                            </svg>
                             <svg id="zones-L21" class="absolute top-0 left-0 hidden" viewBox="0 0 100 100" preserveAspectRatio="none" style="width:450px; height:650px;">                               
                                <polygon class="zone" data-zone="zone1" points="46.4,10.6 64.6,12.5 61.1,23.7 38.2,21.2 43.3,17.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone2" points="64.6,12.5 82.4,14.2 81.3,18.3 88.0,18.9 86.4,26.2 61.1,23.7 " style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone3" points="82.4,14.2 81.3,18.3 88.0,18.9 88.8,14.8" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone4" points="74.2,24.9 86.4,26.2 85.7,29.2 91.3,30.5 89.3,34.9 72.0,33.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone5" points="72.0,33.2 89.1,34.9 84.4,44.6 69.3,42.6" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone6" points="69.3,42.6 84.6,44.5 80.2,53.1 67.3,51.5" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone7" points="67.1,51.5 72.8,52.2 72.0,56.2 66.0,55.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone8" points="72.8,52.3 80.2,53.1 78.4,56.9 72.0,56.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone9" points="66.0,55.4 78.6,56.9 75.7,62.2 64.6,60.9" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone10" points="64.4,60.9 75.5,62.3 71.7,70.3 62.2,69.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone11" points="62.2,69.4 71.7,70.3 69.7,74.6 61.1,73.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone12" points="61.1,73.5 69.7,74.5 67.7,78.8 60.2,77.7" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone13" points="57.7,77.4 67.7,78.8 63.3,87.5 55.3,86.5" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone14" points="40.8,66.5 34.1,83.4 55.5,86.6 57.7,77.4 59.9,77.7 61.5,72.0 50.8,70.6 51.5,67.8" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone15" points="51.9,66.6 59.0,67.7 57.9,71.7 50.8,70.6" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone16" points="53.5,61.7 60.4,62.6 59.0,67.7 51.9,66.6" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone17" points="51.5,55.5 49.5,61.1 60.6,62.5 63.0,53.7 56.1,52.9 55.2,56.0 51.5,55.5" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone18" points="57.0,50.6 56.1,52.9 63.0,53.7 63.5,51.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone19" points="63.0,24.0 61.9,26.9 69.7,27.8 70.4,24.8" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone20" points="53.7,22.9 52.6,25.8 61.9,26.9 62.8,24.0" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone21" points="38.6,45.1 45.0,45.8 43.9,49.2 37.2,48.5" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone22" points="37.2,48.5 43.9,49.2 42.6,52.6 35.9,51.7" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone23" points="35.2,53.5 41.9,54.3 39.6,60.4 32.8,59.5" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone24" points="32.8,59.5 39.6,60.4 38.4,64.2 31.2,63.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone25" points="70.4,24.6 74.1,25.0 61.3,71.8 58.1,71.5" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone26" points="33.9,83.3 0.8,78.7 12.9,62.3 40.8,66.4" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone27" points="31.0,63.3 38.1,64.2 37.5,65.9 12.9,62.3 26.9,43.9 38.3,45.1" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone" data-zone="zone28" points="44.9,45.8 26.9,43.9 27.8,42.8 37.3,21.9 38.2,21.2 53.7,22.8" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <!-- <polygon class="zone " data-zone="zone1" points="46.4,10.6 64.6,12.5 61.1,23.7 38.8,20.6 43.3,17.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone " data-zone="zone1" points="46.4,10.6 64.6,12.5 61.1,23.7 38.8,20.6 43.3,17.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon>
                                <polygon class="zone " data-zone="zone1" points="46.4,10.6 64.6,12.5 61.1,23.7 38.8,20.6 43.3,17.2" style="fill-opacity:0.7;stroke:black; stroke-width:0.5;"></polygon> -->
                                
                            </svg>
                            <!-- <div id="mouse-coords" 
                                class="absolute top-2 left-2 bg-white/70 p-1 rounded text-xs text-black">
                                X: 0, Y: 0
                            </div> -->
                        </div>
                        
                        <!-- Legend -->
                        <div class="absolute bottom-2 right-2 bg-white/30 p-2 rounded-lg text-sm">
                            <div class="flex items-center mb-1">
                                <span class="bg-success rounded-full w-3 h-3 inline-block mr-2"></span>
                                <span><p class = "text-black">Available</p></span>
                            </div>
                            <div class="flex items-center">
                                <span class="bg-danger rounded-full w-3 h-3 inline-block mr-2"></span>
                                <span><p class = "text-black">Occupied</p></span>
                            </div>
                        </div>
                    </div>
            </section>

            <!-- CO2e Reduction Table -->
            <section class="card">
                <div class="card-header">
                    <span>TOP 5 ZONES CO2e REDUCTION</span>
                    <div class="text-sm text-blue-900">
                        <i class="fa fa-info-circle mr-1"></i> Values update every minute
                    </div>
                </div>
                <div class="card-body">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-white/20">
                                    <th class="table-cell text-left">ZONE</th>
                                    <th class="table-cell text-right">CO2e REDUCTION (Kg)</th>
                                    <th class="table-cell text-center">STATUS</th>
                                </tr>
                            </thead>
                            <tbody id="co2e-table-body">
                                <!-- Table rows will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- CO2e Reduction Chart -->
            <section class="card">
                <div class="card-header">
                    <span id="chart-title">LAST 12 MONTHS CO2e REDUCTION (Kg)</span>
                    <div class="flex items-center">
                        <button id="toggle-chart" class="bg-white/10 hover:bg-white/20 px-3 py-1 rounded text-sm transition-colors">
                            <i class="fa fa-exchange mr-1"></i> Switch to 14 Days
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="h-50">
                        <canvas id="co2e-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Energy Efficiency Score -->
           <!-- 
               

                <div class="flex justify-between items-center">
                    <canvas id="efficiency-chart" class="w-1/2 h-1/2"></canvas>
                    <canvas id="efficiency-chart2" class="w-full h-1/2"></canvas>
                </div>
            -->
            <section class="card">
            <div class="flex justify-between items-center p-4">
                <span class="font-bold">ENERGY EFFICIENCY SCORE</span>
                <div class="text-sm font-medium text-accent">87/100</div>
            </div>
            <div  class="flex justify-between">
                <div class="flex flex-col items-center">
                <canvas id="efficiency-chart" class="w-1/2 h-48"></canvas>
                </div>
                <div class="flex flex-col items-center">
                <canvas id="efficiency-chart2" class="w-1/2 h-48"></canvas>
                </div>
            </div>
            </section> 



        </main>

        
    </div>

    <script>
        // Mock data
        const zones = [
            { id: 'zone1', name:  'Workstation A', co2eReduction: 185, status: 'available' },
            { id: 'zone2', name:  'Workstation B', co2eReduction: 210, status: 'occupied' },
            { id: 'zone3', name:  'Meeting Room1', co2eReduction: 195, status: 'available' },
            { id: 'zone4', name:  'Meeting Room2', co2eReduction: 225, status: 'occupied' },
            { id: 'zone5', name:  'Meeting Room3', co2eReduction: 175, status: 'available' },
            { id: 'zone15', name:  'Meeting Room4', co2eReduction: 175, status: 'available' },
            { id: 'zone6', name:  'Reception', co2eReduction: 165, status: 'occupied' },
            { id: 'zone7', name:  'Pantry1', co2eReduction: 165, status: 'occupied' },
            { id: 'zone8', name:  'Pantry2', co2eReduction: 165, status: 'occupied' },
            { id: 'zone9', name:  'Pantry3', co2eReduction: 165, status: 'available' },
            { id: 'zone10', name: 'Male Toilet', co2eReduction: 165, status: 'occupied' },
            { id: 'zone11', name: 'Female Toilet', co2eReduction: 165, status: 'available' },
            { id: 'zone12', name: 'Lobby', co2eReduction: 165, status: 'available' },
            { id: 'zone13', name: 'Lift Area', co2eReduction: 165, status: 'available' },
            { id: 'zone14', name: 'Corridore', co2eReduction: 165, status: 'occupied' },
            { id: 'zone15', name: 'Corridore1', co2eReduction: 165, status: 'available' },
            { id: 'zone16', name: 'Corridore2', co2eReduction: 165, status: 'occupied' },
            { id: 'zone17', name: 'room1', co2eReduction: 165, status: 'available' },
            { id: 'zone18', name: 'room2', co2eReduction: 165, status: 'occupied' },
            { id: 'zone19', name: 'room3', co2eReduction: 165, status: 'available' },
            { id: 'zone20', name: 'room4', co2eReduction: 165, status: 'occupied' },
            { id: 'zone21', name: 'room5', co2eReduction: 165, status: 'available' },
            { id: 'zone22', name: 'room6', co2eReduction: 165, status: 'available' },
            { id: 'zone23', name: 'room7', co2eReduction: 165, status: 'available' },
            { id: 'zone24', name: 'room7', co2eReduction: 165, status: 'occupied' },
            { id: 'zone25', name: 'room7', co2eReduction: 165, status: 'occupied' },
            { id: 'zone26', name: 'room7', co2eReduction: 165, status: 'available' },
            { id: 'zone27', name: 'room7', co2eReduction: 165, status: 'available' },
            { id: 'zone28', name: 'room7', co2eReduction: 165, status: 'occupied' }
        ];

        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const last12MonthsData = [1850, 1920, 2010, 1980, 2100, 2150, 2200, 2250, 2300, 2350, 2400, 2450];
        
        const days = Array.from({length: 14}, (_, i) => `Day ${i+1}`);
        const last14DaysData = [85, 92, 88, 95, 100, 105, 98, 110, 115, 120, 118, 125, 130, 135];

        const efficiencyCategories = ['Lighting', 'HVAC', 'Equipment', 'Water', 'Overall'];
        const efficiencyScores = [82, 90, 78, 95, 87];
        const efficiencyCategories2 = ['Tokyo, Japan', 'New York, USA', 'Singapore', 'CICC'];
        const efficiencyScores2 = [73.8, 77.2, 78.4, 87];
        // DOM Elements
        const co2eTableBody = document.getElementById('co2e-table-body');
        const co2eChartCanvas = document.getElementById('co2e-chart');
        const efficiencyChartCanvas = document.getElementById('efficiency-chart');
        const horizontalChartCanvas = document.getElementById('efficiency-chart2');
        const toggleChartBtn = document.getElementById('toggle-chart');
        const chartTitle = document.getElementById('chart-title');
        const lastUpdatedTime = document.getElementById('last-updated-time');
        const lastUpdatedDate = document.getElementById('last-updated-date');
        const zoneElements = document.querySelectorAll('.zone');
        const container = document.getElementById('floorplan-container');
        // const coordsDisplay = document.getElementById('mouse-coords');

        // container.addEventListener('mousemove', (event) => {
        //     // Get mouse position relative to container
        //     const rect = container.getBoundingClientRect();
        //     const x = ((event.clientX - rect.left) / rect.width * 100).toFixed(1);
        //     const y = ((event.clientY - rect.top) / rect.height * 100).toFixed(1);

        //     // Update text
        //     coordsDisplay.textContent = `${x},${y}`;
        // });
        container.addEventListener("click", () => {
            console.log(coordsDisplay.textContent); 
            // Logs: "X: 0, Y: 0" (or whatever the current text is)
        });
        container.addEventListener("contextmenu", function(event) {
        event.preventDefault();
        console.log("hello world from floorplan");
        });

        // Update timestamp
        function updateTimestamp() {
            const now = new Date();
            const formattedDate = now.toISOString().slice(0, 10);
            const formattedTime = now.toTimeString().slice(0, 8);
            lastUpdatedTime.textContent = `${formattedTime}`;
            lastUpdatedDate.textContent = `${formattedDate}`;
        }

        // Initialize zone colors
        function initZoneColors() {
            zoneElements.forEach(el => {
                const zoneId = el.dataset.zone;
                const zone = zones.find(z => z.id === zoneId);
                el.style.fill = zone.status === 'available' ? 'rgba(34, 197, 94, 0.5)' : 'rgba(239, 68, 68, 0.5)';
            });
        }

        // Randomly update zone statuses
        function updateZoneStatuses() {
            zoneElements.forEach(el => {
                const isAvailable = Math.random() > 0.3; // 70% chance available
                el.style.fill = isAvailable ? 'rgba(34, 197, 94, 0.5)' : 'rgba(239, 68, 68, 0.5)';
                
                // Update zone data
                const zoneId = el.dataset.zone;
                const zone = zones.find(z => z.id === zoneId);
                zone.status = isAvailable ? 'available' : 'occupied';
            });
        }

        // Initialize CO2e table
        function initCO2eTable() {
            // Sort zones by CO2e reduction
            const sortedZones = [...zones].sort((a, b) => b.co2eReduction - a.co2eReduction).slice(0, 5);
            
            co2eTableBody.innerHTML = '';
            
            sortedZones.forEach(zone => {
                const row = document.createElement('tr');
                row.className = 'table-row';
                
                row.innerHTML = `
                    <td class="table-cell font-medium">${zone.name}</td>
                    <td class="table-cell text-right font-mono">${zone.co2eReduction.toLocaleString()}</td>
                    <td class="table-cell text-center">
                        <span class="status-${zone.status}"></span>
                        <span>${zone.status === 'available' ? 'Available' : 'Occupied'}</span>
                    </td>
                `;
                
                co2eTableBody.appendChild(row);
            });
        }

        // Update CO2e values
        function updateCO2eValues() {
            zones.forEach(zone => {
                const change = Math.floor(Math.random() * 11) - 5; // -5 to +5
                zone.co2eReduction = Math.max(100, zone.co2eReduction + change);
                
                const changeEl = document.getElementById(`change-${zone.id}`);
                if (changeEl) {
                    const changeClass = change >= 0 ? 'text-success' : 'text-danger';
                    const changeSign = change >= 0 ? '+' : '';
                    changeEl.textContent = `${changeSign}${change}`;
                    changeEl.className = `table-cell text-right font-mono ${changeClass}`;
                }
            });
            
            // Re-sort and update table
            initCO2eTable();
        }

        // CO2e Chart
        let co2eChart;
        let is12MonthsView = true;

        function initCO2eChart() {
            const ctx = co2eChartCanvas.getContext('2d');
            
            co2eChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'CO2e Reduction (Kg)',
                        data: last12MonthsData,
                        borderColor: '#38bdf8',
                        backgroundColor: 'rgba(56, 189, 248, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#ffffff',
                        pointBorderColor: '#38bdf8',
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#e2e8f0',
                            borderColor: '#38bdf8',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return `CO2e Reduction: ${context.raw.toLocaleString()} Kg`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false,
                                drawBorder: false
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#94a3b8',
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    animation: {
                        duration: 1000
                    }
                }
            });
        }

        function toggleChartView() {
            is12MonthsView = !is12MonthsView;
            
            if (is12MonthsView) {
                co2eChart.data.labels = months;
                co2eChart.data.datasets[0].data = last12MonthsData;
                chartTitle.textContent = 'LAST 12 MONTHS CO2e REDUCTION (Kg)';
                toggleChartBtn.innerHTML = '<i class="fa fa-exchange mr-1"></i> Switch to 14 Days';
            } else {
                co2eChart.data.labels = days;
                co2eChart.data.datasets[0].data = last14DaysData;
                chartTitle.textContent = 'LAST 14 DAYS CO2e REDUCTION (Kg)';
                toggleChartBtn.innerHTML = '<i class="fa fa-exchange mr-1"></i> Switch to 12 Months';
            }
            
            co2eChart.update();
        }
        let currentFloor = "L21";
        function switchFloor() {
            const img = document.getElementById("floorplan-img");
            const zonesL20 = document.getElementById("zones-L20");
            const zonesL21 = document.getElementById("zones-L21");
            if (currentFloor === "L21") {
                img.src = "L21.png";
                zonesL20.classList.add("hidden");
                zonesL21.classList.remove("hidden");
                currentFloor = "L20";
            } else {
                img.src = "L20.png";
                zonesL20.classList.remove("hidden");
                zonesL21.classList.add("hidden");
                currentFloor = "L21";
            }
            console.log(currentFloor);
        }
        // Energy Efficiency Chart
        function initEfficiencyChart() {
            const ctx = efficiencyChartCanvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: efficiencyCategories,
                    datasets: [{
                        label: 'Score',
                        data: efficiencyScores,
                        backgroundColor: [
                            'rgba(56, 189, 248, 0.7)',
                            'rgba(14, 165, 233, 0.7)',
                            'rgba(6, 182, 212, 0.7)',
                            'rgba(8, 145, 178, 0.7)',
                            'rgba(12, 74, 110, 0.7)'
                        ],
                        borderColor: [
                            'rgba(56, 189, 248, 1)',
                            'rgba(14, 165, 233, 1)',
                            'rgba(6, 182, 212, 1)',
                            'rgba(8, 145, 178, 1)',
                            'rgba(12, 74, 110, 1)'
                        ],
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#e2e8f0',
                            borderColor: '#38bdf8',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return `Score: ${context.raw}/100`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false,
                                drawBorder: false
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#94a3b8',
                                stepSize: 20,
                                max: 100
                            }
                        }
                    },
                    animation: {
                        duration: 1000
                    }
                }
            });
        }
        function fetchWeather() {
        fetch("https://data.weather.gov.hk/weatherAPI/opendata/weather.php?dataType=rhrread&station=HKO&lang=en")
            .then(response => response.json())
            .then(data => {
            // Temperature at Hong Kong Observatory
            const tempData = data.temperature.data.find(
                station => station.place === "Hong Kong Observatory"
            );
            document.getElementById("temp").innerText = tempData.value;

            // Humidity at Hong Kong Observatory
            const humidityData = data.humidity.data.find(
                station => station.place === "Hong Kong Observatory"
            );
            document.getElementById("humidity").innerText = humidityData.value;

            // Forecast icon number
            const iconNumber = data.icon[0];
            // Use HKO official icon URL
            document.getElementById("icon").src =
                "https://www.hko.gov.hk/images/HKOWxIconOutline/pic" + iconNumber + ".png";
            })
            .catch(err => console.error("Error fetching HKO data:", err));
        }
        function initHorizontalEfficiencyChart() {
            const ctx = horizontalChartCanvas.getContext('2d');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: efficiencyCategories2,
                    datasets: [{
                        label: 'Score',
                        data: efficiencyScores,
                        backgroundColor: [
                            'rgba(56, 189, 248, 0.7)',
                            'rgba(14, 165, 233, 0.7)',
                            'rgba(6, 182, 212, 0.7)',
                            'rgba(8, 145, 178, 0.7)',
                            'rgba(12, 74, 110, 0.7)'
                        ],
                        borderColor: [
                            'rgba(56, 189, 248, 1)',
                            'rgba(14, 165, 233, 1)',
                            'rgba(6, 182, 212, 1)',
                            'rgba(8, 145, 178, 1)',
                            'rgba(12, 74, 110, 1)'
                        ],
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    indexAxis: 'y',   // ðŸ‘ˆ this makes bars horizontal
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#e2e8f0',
                            borderColor: '#38bdf8',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return `Score: ${context.raw}/100`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(148, 163, 184, 0.1)', drawBorder: false },
                            ticks: { color: '#94a3b8', stepSize: 20, max: 100 }
                        },
                        y: {
                            grid: { display: false, drawBorder: false },
                            ticks: { color: '#94a3b8' }
                        }
                    },
                    animation: { duration: 1000 }
                }
            });
        }

        // Initialize everything
        function init() {
            updateTimestamp();
            initZoneColors();
            fetchWeather();
            initCO2eTable();
            initCO2eChart();
            initEfficiencyChart();
            initHorizontalEfficiencyChart();
            // switchFloor();
            // Event listeners
            toggleChartBtn.addEventListener('click', toggleChartView);
            
            // Set up intervals
            setInterval(updateTimestamp, 1000);
            setInterval(updateZoneStatuses, 30000); // Update zone statuses every 30 seconds
            setInterval(updateCO2eValues, 60000); // Update CO2e values every minute
            
            // Auto toggle chart view every 5 minutes
            setInterval(() => {
                    toggleChartView();
            }, 30000);
            setInterval(fetchWeather, 600000);
            setInterval(switchFloor, 600000);
        }

        // Start the application when the DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
